<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>队伍</title>
    <link rel="stylesheet" href="/css/teaminfo.css">
</head>
<body>
<header>
    <nav class="navbar">
        <div class="logo">
            <img src="/icon/LogoIcon.svg" alt="Logo">
        </div>
        <ul class="navigation">
            <li><a href="#">首页</a></li>
            <li><a href="#">组队</a></li>
            <li><a href="#">人才</a></li>
            <li><a href="#">任务</a></li>
        </ul>
        <div class="search-bar">
            <input type="text" placeholder="搜索...">
            <button type="submit"><img src="/icon/搜索.svg" alt="搜索"></button>
        </div>
        <button class="publish-btn">发布</button>
        <div class="login-register">
            <a href="#">登录 / 注册</a>
        </div>
        <div class="navbar-menu" id="sidebarToggle">
            <img src="/icon/菜单_o.svg" alt="菜单">
        </div>
    </nav>
</header>
<div class="sidebar" id="sidebar">
    <ul class="sidebar-menu">
        <li class="menu-item">
            <img src="/icon/UserIcon.svg" alt="个人信息图标">
            <span>个人信息</span>
        </li>
        <li class="menu-item">
            <img src="/icon/ResumeIcon.svg" alt="我的简历图标">
            <span>我的简历</span>
        </li>
        <li class="menu-item">
            <img src="/icon/TeamIcon.svg" alt="我的队伍图标">
            <span>我的队伍</span>
        </li>
        <li class="menu-item">
            <img src="/icon/historyTask.svg" alt="历史任务图标">
            <span>历史任务</span>
        </li>
    </ul>
</div>
<div>&nbsp;</div>
<div>
    <h1>队伍详情</h1>
</div>
<div class="contain">
    <div class="main">
        <div class="teamname">冒险者小队</div>
        <div class="competitionname">第一届大赛</div>
        <div class="introduction">AnyonesLegend（简称：AL）于2021年12月1日正式成立，AL使用一个熊猫大侠的形象作为LOGO，

            熊猫是中国最具代表性的动物，其中也涵盖了我们想将中华文化传递全球的愿景，熊猫大侠也诠释了

            无所畏惧的中华侠义精神。AL英雄联盟职业战队作为LPL联盟成员之一，“不忘初心，荣耀彼此”是我

            们的信念，我们也将不断超越自我，踏上传奇之路！</div>
        <h2>队长</h2>
        <div class="teammleader">队长</div>
        <h2>小队成员</h2>
        <div class="teammumber">成员a,成员b,成员c</div>
        <h2>我们需要</h2>
        <div class="need">美术家</div>
        <center><a href="/talk"><button type="submit" id="submit" class="btn">与队长交流
            <span class="ripple"></span></button></a></center>
    </div>
</div>
<script src="/js/carousel.js"></script>
<script src="/js/sidebar.js"></script>
<script src="/js/getUserInfo.js"></script>
<script src="/js/updateTopLab.js"></script>
<script>
    document.addEventListener("DOMContentLoaded", function() {
        // 获取当前 URL 的路径部分
        const path = window.location.pathname;
        // 提取 id
        const parts = path.split('/');
        const teamId = parts[parts.length - 1];
        fetch(`/team/info/${teamId}`)
            .then(response => response.json())
            .then(data => {
                if (data.code === 200 && data.data) {
                    const teamData = data.data;
                    document.querySelector('.teamname').innerText = teamData.teamName;
                    document.querySelector('.introduction').innerText = teamData.teamInfo;
                    document.querySelector('.competitionname').innerText = teamData.taskName;
                    document.querySelector('.teammleader').innerText = `队长: ${teamData.captainName}`;

                    // 更新工作职位
                    const jobsContainer = document.querySelector('.need');
                    if (teamData.jobs.length > 0) {
                        jobsContainer.innerHTML = '';
                        teamData.jobs.forEach(job => {
                            const jobLink = document.createElement('a');
                            jobLink.href = '#';
                            jobLink.innerText = job.jobTitle;
                            jobsContainer.appendChild(jobLink);
                            jobsContainer.appendChild(document.createTextNode(', ')); // 添加逗号分隔符
                        });
                        // 移除最后一个多余的逗号
                        if (jobsContainer.lastChild.textContent === ', ') {
                            jobsContainer.removeChild(jobsContainer.lastChild);
                        }
                    } else {
                        jobsContainer.innerText = '暂无职位需求';
                    }

                    // 更新小队成员
                    const membersContainer = document.querySelector('.teammumber');
                    if (teamData.teamMembers.length > 0) {
                        membersContainer.innerHTML = '';
                        teamData.teamMembers.forEach(member => {
                            const memberLink = document.createElement('a');
                            memberLink.href = '#';
                            memberLink.innerText = member.username;
                            membersContainer.appendChild(memberLink);
                            membersContainer.appendChild(document.createTextNode(', ')); // 添加逗号分隔符
                        });
                        // 移除最后一个多余的逗号
                        if (membersContainer.lastChild.textContent === ', ') {
                            membersContainer.removeChild(membersContainer.lastChild);
                        }
                    } else {
                        membersContainer.innerText = '暂无小队成员';
                    }

                    // 修改超链接
                    const captainId = teamData.captainId;
                    const talkLink = document.querySelector('a[href="/talk"]');
                    talkLink.href = `/teaminfo/${teamId}/talk/${captainId}`;
                } else {
                    console.error('Failed to load team information:', data.message);
                }
            })
            .catch(error => console.error('Error fetching team information:', error));
    });
</script>
</body>
</html>